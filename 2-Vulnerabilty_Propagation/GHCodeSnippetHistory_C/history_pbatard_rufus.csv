,repo,origin_commit,file,code_context,commit_date,line_vuln,code_vuln
0,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,754,  if (boot_type == BT_NON_BOOTABLE) {                ^
1,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,392, err = GetLastError()
2,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,400, err = GetLastError()
3,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,1885, for (i = 0
4,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,640, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
5,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,217, char tmp[32]
6,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,973," char *log_buffer = NULL, *filepath"
7,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,1091," static char inst_str[] = "" [1/#]"""
8,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,1092, int i
9,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,2019, char path[MAX_PATH]
10,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,3086,     char cmdline[256]
11,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,3087,     static const char* ps_cmd[2] = {                        ^
12,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,3156, INPUT* input
13,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,3160, int i
14,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,1926," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
15,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,202," return GetRegistryKey64(root, key, &val)"
16,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,206," GetRegistryKey64(root, key, &val)"
17,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
18,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,223," GetRegistryKey32(root, key, &val)"
19,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,201, LONGLONG val
20,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,205, LONGLONG val
21,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,218, DWORD val
22,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,222, DWORD val
23,pbatard/rufus,b30e3b387a3ca7a5e2fddebcc2c8f9538a89b868,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 02:49:15 +0100,3159," HANDLE hogmutex = NULL, hFile = NULL"
24,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,754,  if (boot_type == BT_NON_BOOTABLE) {                ^
25,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,392, err = GetLastError()
26,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,400, err = GetLastError()
27,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,1885, for (i = 0
28,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,640, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
29,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,217, char tmp[32]
30,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,973," char *log_buffer = NULL, *filepath"
31,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,1091," static char inst_str[] = "" [1/#]"""
32,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,1092, int i
33,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,2019, char path[MAX_PATH]
34,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,3086,     char cmdline[256]
35,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,3087,     static const char* ps_cmd[2] = {                        ^
36,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,3156, INPUT* input
37,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,3160, int i
38,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,1926," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
39,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,202," return GetRegistryKey64(root, key, &val)"
40,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,206," GetRegistryKey64(root, key, &val)"
41,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
42,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,223," GetRegistryKey32(root, key, &val)"
43,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,201, LONGLONG val
44,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,205, LONGLONG val
45,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,218, DWORD val
46,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,222, DWORD val
47,pbatard/rufus,a519e3b03b8e5462a4d00b59c40831028def8dbd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-10-23 15:14:46 +0100,3159," HANDLE hogmutex = NULL, hFile = NULL"
48,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,754,  if (boot_type == BT_NON_BOOTABLE) {                ^
49,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,392, err = GetLastError()
50,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,400, err = GetLastError()
51,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,1885, for (i = 0
52,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,640, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
53,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,217, char tmp[32]
54,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,973," char *log_buffer = NULL, *filepath"
55,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,1091," static char inst_str[] = "" [1/#]"""
56,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,1092, int i
57,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,2019, char path[MAX_PATH]
58,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,3086,     char cmdline[256]
59,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,3087,     static const char* ps_cmd[2] = {                        ^
60,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,3156, INPUT* input
61,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,3160, int i
62,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,1926," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
63,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,202," return GetRegistryKey64(root, key, &val)"
64,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,206," GetRegistryKey64(root, key, &val)"
65,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
66,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,223," GetRegistryKey32(root, key, &val)"
67,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,201, LONGLONG val
68,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,205, LONGLONG val
69,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,218, DWORD val
70,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,222, DWORD val
71,pbatard/rufus,d840083a32ee3f6da470a1c5a744fc0899625915,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-16 18:53:52 +0000,3159," HANDLE hogmutex = NULL, hFile = NULL"
72,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,754,  if (boot_type == BT_NON_BOOTABLE) {                ^
73,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,392, err = GetLastError()
74,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,400, err = GetLastError()
75,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,1885, for (i = 0
76,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,640, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
77,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,217, char tmp[32]
78,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,973," char *log_buffer = NULL, *filepath"
79,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,1091," static char inst_str[] = "" [1/#]"""
80,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,1092, int i
81,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,2019, char path[MAX_PATH]
82,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,3086,     char cmdline[256]
83,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,3087,     static const char* ps_cmd[2] = {                        ^
84,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,3156, INPUT* input
85,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,3160, int i
86,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,1926," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
87,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,202," return GetRegistryKey64(root, key, &val)"
88,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,206," GetRegistryKey64(root, key, &val)"
89,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
90,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,223," GetRegistryKey32(root, key, &val)"
91,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,201, LONGLONG val
92,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,205, LONGLONG val
93,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,218, DWORD val
94,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,222, DWORD val
95,pbatard/rufus,eeca1f279c495092bdcbe4207585a7b7e381a688,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2021-11-22 20:11:47 +0000,3159," HANDLE hogmutex = NULL, hFile = NULL"
96,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,392, err = GetLastError()
97,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,400, err = GetLastError()
98,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,1883, for (i = 0
99,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,640, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
100,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,217, char tmp[32]
101,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,970," char *log_buffer = NULL, *filepath"
102,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,1088," static char inst_str[] = "" [1/#]"""
103,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,1089, int i
104,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,2017, char path[MAX_PATH]
105,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,3084,     char cmdline[256]
106,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,3085,     static const char* ps_cmd[2] = {                        ^
107,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,3154, INPUT* input
108,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,3158, int i
109,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,1924," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
110,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,202," return GetRegistryKey64(root, key, &val)"
111,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,206," GetRegistryKey64(root, key, &val)"
112,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
113,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,223," GetRegistryKey32(root, key, &val)"
114,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,201, LONGLONG val
115,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,205, LONGLONG val
116,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,218, DWORD val
117,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,222, DWORD val
118,pbatard/rufus,c28f9bc49184af4062cac63d9dc78450c5731418,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 12:57:26 +0100,3157," HANDLE hogmutex = NULL, hFile = NULL"
119,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,392, err = GetLastError()
120,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,400, err = GetLastError()
121,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,1884, for (i = 0
122,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,641, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
123,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,218, char tmp[32]
124,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,971," char *log_buffer = NULL, *filepath"
125,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,1089," static char inst_str[] = "" [1/#]"""
126,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,1090, int i
127,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,2018, char path[MAX_PATH]
128,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,3085,     char cmdline[256]
129,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,3086,     static const char* ps_cmd[2] = {                        ^
130,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,3155, INPUT* input
131,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,3159, int i
132,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,1925," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
133,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,202," return GetRegistryKey64(root, key, &val)"
134,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,206," GetRegistryKey64(root, key, &val)"
135,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
136,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,223," GetRegistryKey32(root, key, &val)"
137,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,201, LONGLONG val
138,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,205, LONGLONG val
139,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,218, DWORD val
140,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,222, DWORD val
141,pbatard/rufus,ef2ff7179d09a7d1ac9e9943d901bd823e422958,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-05 18:33:59 +0000,3158," HANDLE hogmutex = NULL, hFile = NULL"
142,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,392, err = GetLastError()
143,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,400, err = GetLastError()
144,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,1887, for (i = 0
145,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,641, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
146,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,218, char tmp[32]
147,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,971," char *log_buffer = NULL, *filepath"
148,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,1089," static char inst_str[] = "" [1/#]"""
149,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,1090, int i
150,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,2021, char path[MAX_PATH]
151,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,3088,     char cmdline[256]
152,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,3089,     static const char* ps_cmd[2] = {                        ^
153,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,3158, INPUT* input
154,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,3162, int i
155,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,1928," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
156,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,202," return GetRegistryKey64(root, key, &val)"
157,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,206," GetRegistryKey64(root, key, &val)"
158,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
159,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,223," GetRegistryKey32(root, key, &val)"
160,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,201, LONGLONG val
161,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,205, LONGLONG val
162,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,218, DWORD val
163,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,222, DWORD val
164,pbatard/rufus,a47072c3c6e4b38b80fbc14eee645981c48afd54,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-01-07 13:27:15 +0000,3161," HANDLE hogmutex = NULL, hFile = NULL"
165,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,392, err = GetLastError()
166,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,400, err = GetLastError()
167,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,1888, for (i = 0
168,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,642, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
169,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,218, char tmp[32]
170,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,972," char *log_buffer = NULL, *filepath"
171,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,1090," static char inst_str[] = "" [1/#]"""
172,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,1091, int i
173,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,2022, char path[MAX_PATH]
174,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,3089,     char cmdline[256]
175,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,3090,     static const char* ps_cmd[2] = {                        ^
176,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,3159, INPUT* input
177,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,3163, int i
178,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,1929," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
179,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,202," return GetRegistryKey64(root, key, &val)"
180,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,206," GetRegistryKey64(root, key, &val)"
181,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
182,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,223," GetRegistryKey32(root, key, &val)"
183,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,201, LONGLONG val
184,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,205, LONGLONG val
185,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,218, DWORD val
186,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,222, DWORD val
187,pbatard/rufus,ebaa7d561a262e96830c03ac98e3689f2a70e6d0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;	",2022-02-04 17:41:44 +0000,3162," HANDLE hogmutex = NULL, hFile = NULL"
188,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,392, err = GetLastError()
189,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,400, err = GetLastError()
190,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,1889, for (i = 0
191,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,642, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
192,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,218, char tmp[32]
193,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,972," char *log_buffer = NULL, *filepath"
194,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,1090," static char inst_str[] = "" [1/#]"""
195,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,1091, int i
196,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,2023, char path[MAX_PATH]
197,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,3090,     char cmdline[256]
198,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,3091,     static const char* ps_cmd[2] = {                        ^
199,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,3160, INPUT* input
200,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,3164, int i
201,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,1930," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
202,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,202," return GetRegistryKey64(root, key, &val)"
203,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,206," GetRegistryKey64(root, key, &val)"
204,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
205,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,223," GetRegistryKey32(root, key, &val)"
206,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,201, LONGLONG val
207,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,205, LONGLONG val
208,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,218, DWORD val
209,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,222, DWORD val
210,pbatard/rufus,23e79ad9070cc9c59227ba1f8225c462163d9e75,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-02-11 18:47:41 +0000,3163," HANDLE hogmutex = NULL, hFile = NULL"
211,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,392, err = GetLastError()
212,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,400, err = GetLastError()
213,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,1890, for (i = 0
214,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,642, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
215,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,218, char tmp[32]
216,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,972," char *log_buffer = NULL, *filepath"
217,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,1090," static char inst_str[] = "" [1/#]"""
218,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,1091, int i
219,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,2024, char path[MAX_PATH]
220,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,3091,     char cmdline[256]
221,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,3092,     static const char* ps_cmd[2] = {                        ^
222,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,3161, INPUT* input
223,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,3165, int i
224,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,1931," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
225,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,202," return GetRegistryKey64(root, key, &val)"
226,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,206," GetRegistryKey64(root, key, &val)"
227,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
228,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,223," GetRegistryKey32(root, key, &val)"
229,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,201, LONGLONG val
230,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,205, LONGLONG val
231,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,218, DWORD val
232,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,222, DWORD val
233,pbatard/rufus,0de209ee5342b20d5538996c13df986b3fcc1089,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-03-11 16:51:59 +0000,3164," HANDLE hogmutex = NULL, hFile = NULL"
234,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,392, err = GetLastError()
235,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,400, err = GetLastError()
236,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,1890, for (i = 0
237,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,642, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
238,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,218, char tmp[32]
239,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,972," char *log_buffer = NULL, *filepath"
240,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,1090," static char inst_str[] = "" [1/#]"""
241,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,1091, int i
242,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,2024, char path[MAX_PATH]
243,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,3087,     char cmdline[256]
244,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,3088,     static const char* ps_cmd[2] = {                        ^
245,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,3157, INPUT* input
246,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,3161, int i
247,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,1931," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
248,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,202," return GetRegistryKey64(root, key, &val)"
249,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,206," GetRegistryKey64(root, key, &val)"
250,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
251,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,223," GetRegistryKey32(root, key, &val)"
252,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,201, LONGLONG val
253,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,205, LONGLONG val
254,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,218, DWORD val
255,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,222, DWORD val
256,pbatard/rufus,d029551929243e9c308885120727ceaa4250b7dd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-12 13:55:33 +0100,3160," HANDLE hogmutex = NULL, hFile = NULL"
257,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,392, err = GetLastError()
258,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,400, err = GetLastError()
259,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,1892, for (i = 0
260,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,642, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
261,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,218, char tmp[32]
262,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,972," char *log_buffer = NULL, *filepath"
263,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,1090," static char inst_str[] = "" [1/#]"""
264,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,1091, int i
265,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,2026, char path[MAX_PATH]
266,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,3089,     char cmdline[256]
267,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,3090,     static const char* ps_cmd[2] = {                        ^
268,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,3159, INPUT* input
269,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,3163, int i
270,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,1933," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
271,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,202," return GetRegistryKey64(root, key, &val)"
272,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,206," GetRegistryKey64(root, key, &val)"
273,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
274,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,223," GetRegistryKey32(root, key, &val)"
275,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,201, LONGLONG val
276,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,205, LONGLONG val
277,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,218, DWORD val
278,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,222, DWORD val
279,pbatard/rufus,f5abae644265ebcca5bee4a36329094cda9dfd47,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-04-15 11:43:22 +0100,3162," HANDLE hogmutex = NULL, hFile = NULL"
280,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,731," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
281,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,392, err = GetLastError()
282,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,400, err = GetLastError()
283,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,1893, for (i = 0
284,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,643, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
285,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,219, char tmp[32]
286,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,973," char *log_buffer = NULL, *filepath"
287,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,1091," static char inst_str[] = "" [1/#]"""
288,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,1092, int i
289,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,2023, char path[MAX_PATH]
290,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,3083,     char cmdline[256]
291,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,3084,     static const char* ps_cmd[2] = {                        ^
292,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,3153, INPUT* input
293,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,3157, int i
294,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,1934," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
295,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,202," return GetRegistryKey64(root, key, &val)"
296,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,206," GetRegistryKey64(root, key, &val)"
297,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
298,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,223," GetRegistryKey32(root, key, &val)"
299,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,201, LONGLONG val
300,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,205, LONGLONG val
301,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,218, DWORD val
302,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,222, DWORD val
303,pbatard/rufus,c76327f96ebbe0f8c54a4f7dc3cd09b80097838e,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-05-25 13:22:47 +0100,3156," HANDLE hogmutex = NULL, hFile = NULL"
304,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,731," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
305,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,392, err = GetLastError()
306,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,400, err = GetLastError()
307,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,1893, for (i = 0
308,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,643, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
309,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,219, char tmp[32]
310,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,973," char *log_buffer = NULL, *filepath"
311,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,1091," static char inst_str[] = "" [1/#]"""
312,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,1092, int i
313,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,2023, char path[MAX_PATH]
314,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,3083,     char cmdline[256]
315,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,3084,     static const char* ps_cmd[2] = {                        ^
316,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,3153, INPUT* input
317,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,3157, int i
318,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,1934," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
319,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,202," return GetRegistryKey64(root, key, &val)"
320,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,206," GetRegistryKey64(root, key, &val)"
321,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
322,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,223," GetRegistryKey32(root, key, &val)"
323,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,201, LONGLONG val
324,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,205, LONGLONG val
325,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,218, DWORD val
326,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,222, DWORD val
327,pbatard/rufus,591bec3cbe4bc9d78ba126b31444f4a5c03516ef,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-07 16:19:47 +0100,3156," HANDLE hogmutex = NULL, hFile = NULL"
328,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,731," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
329,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,392, err = GetLastError()
330,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,400, err = GetLastError()
331,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,1893, for (i = 0
332,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,643, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
333,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,219, char tmp[32]
334,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,973," char *log_buffer = NULL, *filepath"
335,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,1091," static char inst_str[] = "" [1/#]"""
336,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,1092, int i
337,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,2023, char path[MAX_PATH]
338,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,3083,     char cmdline[256]
339,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,3084,     static const char* ps_cmd[2] = {                        ^
340,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,3153, INPUT* input
341,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,3157, int i
342,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,1934," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
343,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,202," return GetRegistryKey64(root, key, &val)"
344,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,206," GetRegistryKey64(root, key, &val)"
345,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
346,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,223," GetRegistryKey32(root, key, &val)"
347,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,201, LONGLONG val
348,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,205, LONGLONG val
349,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,218, DWORD val
350,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,222, DWORD val
351,pbatard/rufus,d8af83dd14f10126ad417731b3262f72a3ba051f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-08 19:37:24 +0100,3156," HANDLE hogmutex = NULL, hFile = NULL"
352,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,731," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
353,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,392, err = GetLastError()
354,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,400, err = GetLastError()
355,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,1893, for (i = 0
356,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,643, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
357,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,219, char tmp[32]
358,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,973," char *log_buffer = NULL, *filepath"
359,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,1091," static char inst_str[] = "" [1/#]"""
360,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,1092, int i
361,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,2023, char path[MAX_PATH]
362,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,3083,     char cmdline[256]
363,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,3084,     static const char* ps_cmd[2] = {                        ^
364,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,3153, INPUT* input
365,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,3157, int i
366,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,1934," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
367,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,202," return GetRegistryKey64(root, key, &val)"
368,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,206," GetRegistryKey64(root, key, &val)"
369,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
370,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,223," GetRegistryKey32(root, key, &val)"
371,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,201, LONGLONG val
372,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,205, LONGLONG val
373,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,218, DWORD val
374,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,222, DWORD val
375,pbatard/rufus,cd9d3737b104d395485b92fc7ab73b9183a583c3,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-14 23:29:33 +0100,3156," HANDLE hogmutex = NULL, hFile = NULL"
376,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,731," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
377,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,392, err = GetLastError()
378,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,400, err = GetLastError()
379,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,1889, for (i = 0
380,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,643, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
381,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,219, char tmp[32]
382,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,973," char *log_buffer = NULL, *filepath"
383,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,1091," static char inst_str[] = "" [1/#]"""
384,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,1092, int i
385,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,2019, char path[MAX_PATH]
386,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,3079,     char cmdline[256]
387,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,3080,     static const char* ps_cmd[2] = {                        ^
388,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,3149, INPUT* input
389,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,3153, int i
390,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,1930," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
391,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,202," return GetRegistryKey64(root, key, &val)"
392,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,206," GetRegistryKey64(root, key, &val)"
393,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
394,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,223," GetRegistryKey32(root, key, &val)"
395,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,201, LONGLONG val
396,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,205, LONGLONG val
397,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,218, DWORD val
398,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,222, DWORD val
399,pbatard/rufus,9690742d914c08e04e8d0e7aee2e86c2f882cf7b,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-20 13:47:43 +0100,3152," HANDLE hogmutex = NULL, hFile = NULL"
400,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,743," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
401,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,392, err = GetLastError()
402,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,400, err = GetLastError()
403,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,2045, for (i = 0
404,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,655, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
405,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,231, char tmp[32]
406,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,985," char *log_buffer = NULL, *filepath"
407,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,1103," static char inst_str[] = "" [1/#]"""
408,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,1104, int i
409,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,1268," int i, order"
410,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,1271," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
411,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,2175, char path[MAX_PATH]
412,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,3243,     char cmdline[256]
413,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,3244,     static const char* ps_cmd[2] = {                        ^
414,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,3313, INPUT* input
415,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,3317, int i
416,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,2086," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
417,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,202," return GetRegistryKey64(root, key, &val)"
418,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,206," GetRegistryKey64(root, key, &val)"
419,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
420,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,223," GetRegistryKey32(root, key, &val)"
421,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,201, LONGLONG val
422,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,205, LONGLONG val
423,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,218, DWORD val
424,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,222, DWORD val
425,pbatard/rufus,a0d669232cb3442e54a3e640c3e4009d800183a4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-06-23 13:34:24 +0100,3316," HANDLE hogmutex = NULL, hFile = NULL"
426,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,743," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
427,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,392, err = GetLastError()
428,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,400, err = GetLastError()
429,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,2046, for (i = 0
430,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,655, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
431,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,231, char tmp[32]
432,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,985," char *log_buffer = NULL, *filepath"
433,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,1103," static char inst_str[] = "" [1/#]"""
434,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,1104, int i
435,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,1268," int i, order"
436,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,1271," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
437,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,2176, char path[MAX_PATH]
438,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,3244,     char cmdline[256]
439,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,3245,     static const char* ps_cmd[2] = {                        ^
440,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,3314, INPUT* input
441,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,3318, int i
442,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,2087," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
443,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,202," return GetRegistryKey64(root, key, &val)"
444,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,206," GetRegistryKey64(root, key, &val)"
445,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
446,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,223," GetRegistryKey32(root, key, &val)"
447,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,201, LONGLONG val
448,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,205, LONGLONG val
449,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,218, DWORD val
450,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,222, DWORD val
451,pbatard/rufus,d0844bfc70d830e7b8827e86501b6754215c3107,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-23 14:05:52 +0100,3317," HANDLE hogmutex = NULL, hFile = NULL"
452,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,741," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
453,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,392, err = GetLastError()
454,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,400, err = GetLastError()
455,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,2037, for (i = 0
456,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,653, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
457,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,229, char tmp[32]
458,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,983," char *log_buffer = NULL, *filepath"
459,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,1101," static char inst_str[] = "" [1/#]"""
460,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,1102, int i
461,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,1266," int i, order"
462,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,1268," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
463,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,2167, char path[MAX_PATH]
464,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,3235,     char cmdline[256]
465,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,3236,     static const char* ps_cmd[2] = {                        ^
466,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,3305, INPUT* input
467,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,3309, int i
468,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
469,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,2078," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
470,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,202," return GetRegistryKey64(root, key, &val)"
471,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,206," GetRegistryKey64(root, key, &val)"
472,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
473,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,223," GetRegistryKey32(root, key, &val)"
474,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,201, LONGLONG val
475,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,205, LONGLONG val
476,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,218, DWORD val
477,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,222, DWORD val
478,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,1331,  order = 1
479,pbatard/rufus,a25af06b3c7b3fcd0b1570555938ef94cf2dea3c,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 14:27:02 +0100,3308," HANDLE hogmutex = NULL, hFile = NULL"
480,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,744," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
481,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,392, err = GetLastError()
482,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,400, err = GetLastError()
483,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,2055, for (i = 0
484,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,656, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
485,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,232, char tmp[32]
486,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,986," char *log_buffer = NULL, *filepath"
487,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,1104," static char inst_str[] = "" [1/#]"""
488,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,1105, int i
489,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,1269," int i, order"
490,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,1271," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
491,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,2185, char path[MAX_PATH]
492,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,3255,     char cmdline[256]
493,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,3256,     static const char* ps_cmd[2] = {                        ^
494,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,3325, INPUT* input
495,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,3329, int i
496,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
497,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,2096," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
498,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,202," return GetRegistryKey64(root, key, &val)"
499,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,206," GetRegistryKey64(root, key, &val)"
500,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
501,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,223," GetRegistryKey32(root, key, &val)"
502,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,201, LONGLONG val
503,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,205, LONGLONG val
504,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,218, DWORD val
505,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,222, DWORD val
506,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,1334,  order = 1
507,pbatard/rufus,e043a49fa7511c526a164514e7f2b3269a71ea5d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-24 17:47:08 +0100,3328," HANDLE hogmutex = NULL, hFile = NULL"
508,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,744," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
509,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,392, err = GetLastError()
510,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,400, err = GetLastError()
511,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,2055, for (i = 0
512,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,656, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
513,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,232, char tmp[32]
514,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,986," char *log_buffer = NULL, *filepath"
515,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,1104," static char inst_str[] = "" [1/#]"""
516,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,1105, int i
517,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,1269," int i, order"
518,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,1271," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
519,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,2185, char path[MAX_PATH]
520,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,3255,     char cmdline[256]
521,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,3256,     static const char* ps_cmd[2] = {                        ^
522,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,3325, INPUT* input
523,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,3329, int i
524,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
525,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,2096," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
526,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,202," return GetRegistryKey64(root, key, &val)"
527,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,206," GetRegistryKey64(root, key, &val)"
528,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
529,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,223," GetRegistryKey32(root, key, &val)"
530,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,201, LONGLONG val
531,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,205, LONGLONG val
532,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,218, DWORD val
533,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,222, DWORD val
534,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,1334,  order = 1
535,pbatard/rufus,d457a0bafe3b2dd7a1e9c727081967af559d04fd,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-06-25 15:39:05 +0100,3328," HANDLE hogmutex = NULL, hFile = NULL"
536,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,744," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
537,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,392, err = GetLastError()
538,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,400, err = GetLastError()
539,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,2056, for (i = 0
540,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,656, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
541,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,232, char tmp[32]
542,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,986," char *log_buffer = NULL, *filepath"
543,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,1104," static char inst_str[] = "" [1/#]"""
544,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,1105, int i
545,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,1269," int i, order"
546,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,1271," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
547,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,2186, char path[MAX_PATH]
548,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,3256,     char cmdline[256]
549,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,3257,     static const char* ps_cmd[2] = {                        ^
550,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,3326, INPUT* input
551,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,3330, int i
552,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
553,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,2097," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
554,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,202," return GetRegistryKey64(root, key, &val)"
555,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,206," GetRegistryKey64(root, key, &val)"
556,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
557,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,223," GetRegistryKey32(root, key, &val)"
558,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,201, LONGLONG val
559,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,205, LONGLONG val
560,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,218, DWORD val
561,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,222, DWORD val
562,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,1334,  order = 1
563,pbatard/rufus,110f4025b7b4c3f8f2b0db59c1efd398e9c9e9c0,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-05 14:09:41 +0100,3329," HANDLE hogmutex = NULL, hFile = NULL"
564,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,744," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
565,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,392, err = GetLastError()
566,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,400, err = GetLastError()
567,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,2058, for (i = 0
568,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,656, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
569,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,232, char tmp[32]
570,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,986," char *log_buffer = NULL, *filepath"
571,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,1104," static char inst_str[] = "" [1/#]"""
572,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,1105, int i
573,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,1269," int i, order"
574,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,1271," const char* bypass_name[4] = { ""BypassTPMCheck"", ""BypassSecureBootCheck"", ""BypassRAMCheck"", ""BypassStorageCheck"" }"
575,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,2188, char path[MAX_PATH]
576,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,3258,     char cmdline[256]
577,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,3259,     static const char* ps_cmd[2] = {                        ^
578,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,3328, INPUT* input
579,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,3332, int i
580,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
581,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,2099," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
582,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,202," return GetRegistryKey64(root, key, &val)"
583,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,206," GetRegistryKey64(root, key, &val)"
584,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
585,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,223," GetRegistryKey32(root, key, &val)"
586,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,201, LONGLONG val
587,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,205, LONGLONG val
588,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,218, DWORD val
589,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,222, DWORD val
590,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,1334,  order = 1
591,pbatard/rufus,f17e287e397c52392d608422aa25baf92a16f9be,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-07 11:22:39 +0100,3331," HANDLE hogmutex = NULL, hFile = NULL"
592,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,732," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
593,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,392, err = GetLastError()
594,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,400, err = GetLastError()
595,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,2046, for (i = 0
596,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,644, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
597,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,220, char tmp[32]
598,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,974," char *log_buffer = NULL, *filepath"
599,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,1092," static char inst_str[] = "" [1/#]"""
600,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,1093, int i
601,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,1257," int i, order"
602,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,2176, char path[MAX_PATH]
603,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,3245,     char cmdline[256]
604,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,3246,     static const char* ps_cmd[2] = {                        ^
605,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,3315, INPUT* input
606,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,3319, int i
607,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
608,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,2087," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
609,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,202," return GetRegistryKey64(root, key, &val)"
610,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,206," GetRegistryKey64(root, key, &val)"
611,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
612,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,223," GetRegistryKey32(root, key, &val)"
613,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,201, LONGLONG val
614,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,205, LONGLONG val
615,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,218, DWORD val
616,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,222, DWORD val
617,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,1323,  order = 1
618,pbatard/rufus,14f19e527526f8d963424b7fbcd1f0989a8fc2d4,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-08 18:48:02 +0100,3318," HANDLE hogmutex = NULL, hFile = NULL"
619,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,732," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
620,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,392, err = GetLastError()
621,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,400, err = GetLastError()
622,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,2046, for (i = 0
623,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,644, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
624,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,220, char tmp[32]
625,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,974," char *log_buffer = NULL, *filepath"
626,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,1092," static char inst_str[] = "" [1/#]"""
627,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,1093, int i
628,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,1257," int i, order"
629,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,2176, char path[MAX_PATH]
630,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,3245,     char cmdline[256]
631,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,3246,     static const char* ps_cmd[2] = {                        ^
632,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,3315, INPUT* input
633,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,3319, int i
634,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
635,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,2087," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
636,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,202," return GetRegistryKey64(root, key, &val)"
637,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,206," GetRegistryKey64(root, key, &val)"
638,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,219," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
639,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,223," GetRegistryKey32(root, key, &val)"
640,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,201, LONGLONG val
641,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,205, LONGLONG val
642,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,218, DWORD val
643,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,222, DWORD val
644,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,1323,  order = 1
645,pbatard/rufus,5117a3b4a8de29b00e27fefc8de0502cf6c4256a,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-13 18:31:11 +0100,3318," HANDLE hogmutex = NULL, hFile = NULL"
646,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,732," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
647,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,392, err = GetLastError()
648,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,400, err = GetLastError()
649,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,2115, for (i = 0
650,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,644, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
651,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,220, char tmp[32]
652,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,974," char *log_buffer = NULL, *filepath"
653,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,1092," static char inst_str[] = "" [1/#]"""
654,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,1093, int i
655,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,1264," int i, order"
656,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,2245, char path[MAX_PATH]
657,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,3314,     char cmdline[256]
658,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,3315,     static const char* ps_cmd[2] = {                        ^
659,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,3384, INPUT* input
660,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,3388, int i
661,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
662,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,2156," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
663,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,177," return GetRegistryKey64(root, key, &val)"
664,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,181," GetRegistryKey64(root, key, &val)"
665,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
666,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,198," GetRegistryKey32(root, key, &val)"
667,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,176, LONGLONG val
668,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,180, LONGLONG val
669,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,193, DWORD val
670,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,197, DWORD val
671,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,1330,  order = 1
672,pbatard/rufus,9073962fafad155d52f84aec77b5db2e3ffba685,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-19 19:11:06 +0100,3387," HANDLE hogmutex = NULL, hFile = NULL"
673,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,732," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
674,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,392, err = GetLastError()
675,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,400, err = GetLastError()
676,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,2113, for (i = 0
677,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,644, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
678,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,220, char tmp[32]
679,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,974," char *log_buffer = NULL, *filepath"
680,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,1092," static char inst_str[] = "" [1/#]"""
681,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,1093, int i
682,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,1264," int i, order"
683,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,2243, char path[MAX_PATH]
684,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,3312,     char cmdline[256]
685,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,3313,     static const char* ps_cmd[2] = {                        ^
686,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,3382, INPUT* input
687,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,3386, int i
688,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,119,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
689,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,2154," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
690,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,177," return GetRegistryKey64(root, key, &val)"
691,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,181," GetRegistryKey64(root, key, &val)"
692,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
693,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,198," GetRegistryKey32(root, key, &val)"
694,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,176, LONGLONG val
695,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,180, LONGLONG val
696,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,193, DWORD val
697,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,197, DWORD val
698,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,1330,  order = 1
699,pbatard/rufus,c34cbab3b554c22105f4a9b45baf33cfd40dab81,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-22 13:02:02 +0100,3385," HANDLE hogmutex = NULL, hFile = NULL"
700,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,733," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
701,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,392, err = GetLastError()
702,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,400, err = GetLastError()
703,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,1953, for (i = 0
704,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,645, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
705,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,221, char tmp[32]
706,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,975," char *log_buffer = NULL, *filepath"
707,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,1093," static char inst_str[] = "" [1/#]"""
708,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,1094, int i
709,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,2083, char path[MAX_PATH]
710,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,3152,     char cmdline[256]
711,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,3153,     static const char* ps_cmd[2] = {                        ^
712,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,3222, INPUT* input
713,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,3226, int i
714,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
715,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
716,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,1994," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
717,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,177," return GetRegistryKey64(root, key, &val)"
718,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,181," GetRegistryKey64(root, key, &val)"
719,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
720,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,198," GetRegistryKey32(root, key, &val)"
721,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,176, LONGLONG val
722,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,180, LONGLONG val
723,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,193, DWORD val
724,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,197, DWORD val
725,pbatard/rufus,a19828c9d110cd10cc84d73195aa817eae4529a9,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-07-25 13:18:14 +0100,3225," HANDLE hogmutex = NULL, hFile = NULL"
726,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,733," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
727,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,392, err = GetLastError()
728,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,400, err = GetLastError()
729,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,1955, for (i = 0
730,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,645, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
731,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,221, char tmp[32]
732,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,975," char *log_buffer = NULL, *filepath"
733,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,1093," static char inst_str[] = "" [1/#]"""
734,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,1094, int i
735,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,2085, char path[MAX_PATH]
736,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,3154,     char cmdline[256]
737,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,3155,     static const char* ps_cmd[2] = {                        ^
738,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,3224, INPUT* input
739,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,3228, int i
740,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
741,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
742,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,1996," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
743,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,177," return GetRegistryKey64(root, key, &val)"
744,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,181," GetRegistryKey64(root, key, &val)"
745,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
746,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,198," GetRegistryKey32(root, key, &val)"
747,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,176, LONGLONG val
748,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,180, LONGLONG val
749,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,193, DWORD val
750,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,197, DWORD val
751,pbatard/rufus,2c26f838f496c9e39afac22ae61d3be3148b6b10,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-07-27 11:49:26 +0100,3227," HANDLE hogmutex = NULL, hFile = NULL"
752,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,734," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
753,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,392, err = GetLastError()
754,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,400, err = GetLastError()
755,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,1956, for (i = 0
756,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,646, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
757,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,222, char tmp[32]
758,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,976," char *log_buffer = NULL, *filepath"
759,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,1094," static char inst_str[] = "" [1/#]"""
760,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,1095, int i
761,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,2086, char path[MAX_PATH]
762,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,3155,     char cmdline[256]
763,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,3156,     static const char* ps_cmd[2] = {                        ^
764,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,3225, INPUT* input
765,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,3229, int i
766,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
767,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
768,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,1997," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
769,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,177," return GetRegistryKey64(root, key, &val)"
770,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,181," GetRegistryKey64(root, key, &val)"
771,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
772,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,198," GetRegistryKey32(root, key, &val)"
773,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,176, LONGLONG val
774,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,180, LONGLONG val
775,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,193, DWORD val
776,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,197, DWORD val
777,pbatard/rufus,fbad63666efc43118e8a0050d0393e71562a1479,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-08-02 20:14:29 +0100,3228," HANDLE hogmutex = NULL, hFile = NULL"
778,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,734," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
779,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,392, err = GetLastError()
780,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,400, err = GetLastError()
781,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,1956, for (i = 0
782,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,646, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
783,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,222, char tmp[32]
784,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,976," char *log_buffer = NULL, *filepath"
785,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,1094," static char inst_str[] = "" [1/#]"""
786,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,1095, int i
787,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,2086, char path[MAX_PATH]
788,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,3155,     char cmdline[256]
789,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,3156,     static const char* ps_cmd[2] = {                        ^
790,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,3225, INPUT* input
791,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,3229, int i
792,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
793,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
794,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,1997," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
795,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,177," return GetRegistryKey64(root, key, &val)"
796,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,181," GetRegistryKey64(root, key, &val)"
797,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
798,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,198," GetRegistryKey32(root, key, &val)"
799,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,176, LONGLONG val
800,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,180, LONGLONG val
801,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,193, DWORD val
802,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,197, DWORD val
803,pbatard/rufus,4d6c8b72d8df026254c8dae3560e5807153a54eb,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-09-19 10:37:23 +0200,3228," HANDLE hogmutex = NULL, hFile = NULL"
804,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,734," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
805,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,392, err = GetLastError()
806,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,400, err = GetLastError()
807,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,1967, for (i = 0
808,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,646, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
809,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,222, char tmp[32]
810,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,976," char *log_buffer = NULL, *filepath"
811,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,1094," static char inst_str[] = "" [1/#]"""
812,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,1095, int i
813,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,2097, char path[MAX_PATH]
814,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,3147,     char cmdline[256]
815,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,3148,     static const char* ps_cmd[2] = {                        ^
816,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,3217, INPUT* input
817,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,3221, int i
818,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
819,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
820,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,2008," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
821,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,177," return GetRegistryKey64(root, key, &val)"
822,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,181," GetRegistryKey64(root, key, &val)"
823,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
824,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,198," GetRegistryKey32(root, key, &val)"
825,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,176, LONGLONG val
826,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,180, LONGLONG val
827,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,193, DWORD val
828,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,197, DWORD val
829,pbatard/rufus,8814944c357b23ad4ca413a33f9ee5f7eca65a1f,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-10-04 11:58:30 +0100,3220," HANDLE hogmutex = NULL, hFile = NULL"
830,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,734," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
831,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,395, err = GetLastError()
832,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,403, err = GetLastError()
833,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,1967, for (i = 0
834,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,646, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
835,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,222, char tmp[32]
836,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,976," char *log_buffer = NULL, *filepath"
837,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,1094," static char inst_str[] = "" [1/#]"""
838,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,1095, int i
839,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,2097, char path[MAX_PATH]
840,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,3147,     char cmdline[256]
841,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,3148,     static const char* ps_cmd[2] = {                        ^
842,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,3217, INPUT* input
843,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,3221, int i
844,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
845,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
846,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,2008," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
847,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,177," return GetRegistryKey64(root, key, &val)"
848,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,181," GetRegistryKey64(root, key, &val)"
849,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
850,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,198," GetRegistryKey32(root, key, &val)"
851,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,176, LONGLONG val
852,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,180, LONGLONG val
853,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,193, DWORD val
854,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,197, DWORD val
855,pbatard/rufus,c19ef1125ddbd56dacebb835ab3def690da19d6d,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-10-18 13:58:38 +0100,3220," HANDLE hogmutex = NULL, hFile = NULL"
856,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,735," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
857,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,395, err = GetLastError()
858,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,403, err = GetLastError()
859,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,1973, for (i = 0
860,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,647, if ((preferred_fs == FS_UNKNOWN) && (preselected_fs != FS_UNKNOWN)) {                   ^
861,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,223, char tmp[32]
862,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,977," char *log_buffer = NULL, *filepath"
863,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,1095," static char inst_str[] = "" [1/#]"""
864,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,1096, int i
865,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,2103, char path[MAX_PATH]
866,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,3156,     char cmdline[256]
867,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,3157,     static const char* ps_cmd[2] = {                        ^
868,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,3226, INPUT* input
869,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,3230, int i
870,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
871,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
872,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,2014," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
873,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,177," return GetRegistryKey64(root, key, &val)"
874,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,181," GetRegistryKey64(root, key, &val)"
875,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
876,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,198," GetRegistryKey32(root, key, &val)"
877,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,176, LONGLONG val
878,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,180, LONGLONG val
879,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,193, DWORD val
880,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,197, DWORD val
881,pbatard/rufus,a6769e4fb262b590a2550a99ac52c0b1c672a8d5,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-16 16:50:53 +0000,3229," HANDLE hogmutex = NULL, hFile = NULL"
882,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,726," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
883,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,395, err = GetLastError()
884,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,403, err = GetLastError()
885,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,1964, for (i = 0
886,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,223, char tmp[32]
887,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,968," char *log_buffer = NULL, *filepath"
888,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,1086," static char inst_str[] = "" [1/#]"""
889,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,1087, int i
890,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,2094, char path[MAX_PATH]
891,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,3147,     char cmdline[256]
892,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,3148,     static const char* ps_cmd[2] = {                        ^
893,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,3217, INPUT* input
894,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,3221, int i
895,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
896,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
897,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,2005," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
898,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,177," return GetRegistryKey64(root, key, &val)"
899,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,181," GetRegistryKey64(root, key, &val)"
900,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
901,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,198," GetRegistryKey32(root, key, &val)"
902,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,176, LONGLONG val
903,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,180, LONGLONG val
904,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,193, DWORD val
905,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,197, DWORD val
906,pbatard/rufus,9727fd43429e4809db442c788fe31ffcea01ee49,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)	// The creation of ReFS drives was added in Windows 8.1... but then removed by	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect	// if ReFS is available on the system. Oh, and it only applies to fixed media.	if (MediaType != FixedMedia)		return FALSE;	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)		return FALSE;	if (nWindowsBuildNumber < 16000)		return TRUE;	switch (nWindowsEdition) 	case 0x0000000A: // Enterprise Server	case 0x0000001B: // Enterprise N	case 0x00000046: // Enterprise E	case 0x00000048: // Enterprise Eval	case 0x00000054: // Enterprise N Eval	case 0x0000007D: // Enterprise S	case 0x0000007E: // Enterprise S N	case 0x00000081: // Enterprise S Eval	case 0x00000082: // Enterprise S N Eval	case 0x0000008C: // Enterprise Subscription	case 0x0000008D: // Enterprise Subscription N	case 0x000000A1: // Pro Workstation	case 0x000000A2: // Pro Workstation N	case 0x000000AB: // Enterprise G	case 0x000000AC: // Enterprise G N		return TRUE;	default:		return FALSE;",2022-11-16 16:55:41 +0000,3220," HANDLE hogmutex = NULL, hFile = NULL"
907,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,726," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
908,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,395, err = GetLastError()
909,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,403, err = GetLastError()
910,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,1964, for (i = 0
911,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,223, char tmp[32]
912,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,968," char *log_buffer = NULL, *filepath"
913,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,1086," static char inst_str[] = "" [1/#]"""
914,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,1087, int i
915,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,2094, char path[MAX_PATH]
916,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,3147,     char cmdline[256]
917,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,3148,     static const char* ps_cmd[2] = {                        ^
918,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,3217, INPUT* input
919,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,3221, int i
920,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
921,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
922,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,2005," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
923,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,177," return GetRegistryKey64(root, key, &val)"
924,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,181," GetRegistryKey64(root, key, &val)"
925,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
926,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,198," GetRegistryKey32(root, key, &val)"
927,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,176, LONGLONG val
928,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,180, LONGLONG val
929,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,193, DWORD val
930,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,197, DWORD val
931,pbatard/rufus,c2fe08080a7e4e582a3b8ba067d861642def4f50,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-22 13:35:50 +0000,3220," HANDLE hogmutex = NULL, hFile = NULL"
932,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,726," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
933,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,395, err = GetLastError()
934,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,403, err = GetLastError()
935,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,1964, for (i = 0
936,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,223, char tmp[32]
937,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,968," char *log_buffer = NULL, *filepath"
938,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,1086," static char inst_str[] = "" [1/#]"""
939,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,1087, int i
940,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,2094, char path[MAX_PATH]
941,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,3147,     char cmdline[256]
942,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,3148,     static const char* ps_cmd[2] = {                        ^
943,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,3217, INPUT* input
944,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,3221, int i
945,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
946,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
947,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,2005," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
948,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,177," return GetRegistryKey64(root, key, &val)"
949,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,181," GetRegistryKey64(root, key, &val)"
950,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
951,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,198," GetRegistryKey32(root, key, &val)"
952,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,176, LONGLONG val
953,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,180, LONGLONG val
954,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,193, DWORD val
955,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,197, DWORD val
956,pbatard/rufus,ddcbe8ed817880a56c4420dabddaebd20b2608f8,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-11-28 16:41:27 +0000,3220," HANDLE hogmutex = NULL, hFile = NULL"
957,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,727," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
958,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,395, err = GetLastError()
959,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,403, err = GetLastError()
960,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,1965, for (i = 0
961,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,224, char tmp[32]
962,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,969," char *log_buffer = NULL, *filepath"
963,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,1087," static char inst_str[] = "" [1/#]"""
964,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,1088, int i
965,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,2095, char path[MAX_PATH]
966,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,3148,     char cmdline[256]
967,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,3149,     static const char* ps_cmd[2] = {                        ^
968,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,3218, INPUT* input
969,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,3222, int i
970,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
971,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
972,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,2006," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
973,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,177," return GetRegistryKey64(root, key, &val)"
974,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,181," GetRegistryKey64(root, key, &val)"
975,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
976,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,198," GetRegistryKey32(root, key, &val)"
977,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,176, LONGLONG val
978,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,180, LONGLONG val
979,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,193, DWORD val
980,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,197, DWORD val
981,pbatard/rufus,36f4716afde9dacddc12d1c2a6516a929bff12c7,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:15:48 +0000,3221," HANDLE hogmutex = NULL, hFile = NULL"
982,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,727," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
983,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,395, err = GetLastError()
984,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,403, err = GetLastError()
985,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,1965, for (i = 0
986,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,224, char tmp[32]
987,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,969," char *log_buffer = NULL, *filepath"
988,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,1087," static char inst_str[] = "" [1/#]"""
989,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,1088, int i
990,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,2095, char path[MAX_PATH]
991,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,3148,     char cmdline[256]
992,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,3149,     static const char* ps_cmd[2] = {                        ^
993,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,3218, INPUT* input
994,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,3222, int i
995,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
996,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
997,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,2006," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
998,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,177," return GetRegistryKey64(root, key, &val)"
999,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,181," GetRegistryKey64(root, key, &val)"
1000,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
1001,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,198," GetRegistryKey32(root, key, &val)"
1002,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,176, LONGLONG val
1003,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,180, LONGLONG val
1004,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,193, DWORD val
1005,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,197, DWORD val
1006,pbatard/rufus,fab095c043c650f754498ec5ca939ce752b88325,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2022-12-08 11:21:39 +0000,3221," HANDLE hogmutex = NULL, hFile = NULL"
1007,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,727," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
1008,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,395, err = GetLastError()
1009,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,403, err = GetLastError()
1010,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,1967, for (i = 0
1011,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,224, char tmp[32]
1012,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,969," char *log_buffer = NULL, *filepath"
1013,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,1087," static char inst_str[] = "" [1/#]"""
1014,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,1088, int i
1015,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,2097, char path[MAX_PATH]
1016,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,3150,     char cmdline[256]
1017,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,3151,     static const char* ps_cmd[2] = {                        ^
1018,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,3220, INPUT* input
1019,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,3224, int i
1020,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
1021,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
1022,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,2008," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
1023,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,177," return GetRegistryKey64(root, key, &val)"
1024,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,181," GetRegistryKey64(root, key, &val)"
1025,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
1026,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,198," GetRegistryKey32(root, key, &val)"
1027,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,176, LONGLONG val
1028,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,180, LONGLONG val
1029,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,193, DWORD val
1030,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,197, DWORD val
1031,pbatard/rufus,1ce1f47a8bba6e4d2a39d4a6fb49817fa869d855,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-10 20:43:07 +0000,3223," HANDLE hogmutex = NULL, hFile = NULL"
1032,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,728," if ((_stricmp(no_label, rufus_drive[ComboIndex].label) == 0) || (_stricmp(no_label, empty) == 0)                                    ^"
1033,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,395, err = GetLastError()
1034,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,403, err = GetLastError()
1035,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,1968, for (i = 0
1036,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,225, char tmp[32]
1037,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,970," char *log_buffer = NULL, *filepath"
1038,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,1088," static char inst_str[] = "" [1/#]"""
1039,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,1089, int i
1040,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,2109, char path[MAX_PATH]
1041,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,3167,     char cmdline[256]
1042,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,3168,     static const char* ps_cmd[2] = {                        ^
1043,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,3237, INPUT* input
1044,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,3241, int i
1045,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,125,"static __inline uint8_t remap8(uint8_t src, uint8_t* map, const BOOL reverse)                                                     ^"
1046,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,147,"static __inline uint16_t remap16(uint16_t src, uint16_t* map, const BOOL reverse)                                                         ^"
1047,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,2020," SendMessage(hProgress, PBM_SETRANGE, 0, (MAX_PROGRESS<<16) & 0xFFFF0000)"
1048,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,177," return GetRegistryKey64(root, key, &val)"
1049,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,181," GetRegistryKey64(root, key, &val)"
1050,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,194," return (GetRegistryKey32(root, key, &val) && SetRegistryKey32(root, key, val))"
1051,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,198," GetRegistryKey32(root, key, &val)"
1052,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,176, LONGLONG val
1053,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,180, LONGLONG val
1054,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,193, DWORD val
1055,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,197, DWORD val
1056,pbatard/rufus,1dc9fab9175f9f65a5054261ee9d68db497fdf76,src/rufus.c,"static BOOL IsRefsAvailable(MEDIA_TYPE MediaType)
{
	// The creation of ReFS drives was added in Windows 8.1... but then removed by
	// Microsoft in Windows 10 1709, except for the Enterprise and Pro Workstation
	// versions. Oh and VdsService::QueryFileSystemTypes() is *USELESS* to detect
	// if ReFS is available on the system. Oh, and it only applies to fixed media.

	if (MediaType != FixedMedia)
		return FALSE;
	if (nWindowsVersion < WINDOWS_8_1 || nWindowsBuildNumber <= 0)
		return FALSE;
	if (nWindowsBuildNumber < 16000)
		return TRUE;
	switch (nWindowsEdition) {
	case 0x0000000A: // Enterprise Server
	case 0x0000001B: // Enterprise N
	case 0x00000046: // Enterprise E
	case 0x00000048: // Enterprise Eval
	case 0x00000054: // Enterprise N Eval
	case 0x0000007D: // Enterprise S
	case 0x0000007E: // Enterprise S N
	case 0x00000081: // Enterprise S Eval
	case 0x00000082: // Enterprise S N Eval
	case 0x0000008C: // Enterprise Subscription
	case 0x0000008D: // Enterprise Subscription N
	case 0x000000A1: // Pro Workstation
	case 0x000000A2: // Pro Workstation N
	case 0x000000AB: // Enterprise G
	case 0x000000AC: // Enterprise G N
		return TRUE;
	default:
		return FALSE;
	}
}
",2023-01-13 21:49:57 +0000,3240," HANDLE hogmutex = NULL, hFile = NULL"
